<?xml version="1.0" encoding="utf-8" ?>
<!--
    A model file for very basic tests
-->
<opc:ModelDesign
    xmlns:uax="http://opcfoundation.org/UA/2008/02/Types.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ua="http://opcfoundation.org/UA/"
    xmlns:opc="http://opcfoundation.org/UA/ModelDesign.xsd"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:own="urn:open62541.server.application"
    xmlns="urn:open62541.server.application"
    TargetNamespace="urn:open62541.server.application"
    TargetXmlNamespace="urn:open62541.server.application"
    TargetVersion="1.05.02"
    TargetPublicationDate="2025-05-12T00:00:00Z">

    <!--
        Namespace definition for the test devices
    -->
    <opc:Namespaces>
        <opc:Namespace Name="Reference" Prefix="KRITIS3M.Reference">urn:open62541.server.application</opc:Namespace>
        <opc:Namespace Name="OpcUa" Version="1.05.02" PublicationDate="2022-11-01T00:00:00Z" Prefix="Opc.Ua" InternalPrefix="Opc.Ua.Server" XmlNamespace="http://opcfoundation.org/UA/2008/02/Types.xsd">http://opcfoundation.org/UA/</opc:Namespace>
    </opc:Namespaces>
    
    <!--
        Define generic base types for the various controllers, sensors and actuators used in the model.
    -->
    
    <opc:ObjectType SymbolicName="DeviceInfoType" BaseType="ua:BaseObjectType">
        <opc:Description>Base Class for device specific data.</opc:Description>
        <opc:Children>
            <!-- proterty definition for our generic sensor -->
            <opc:Property SymbolicName="DeviceID" DataType="ua:String" ValueRank="Scalar"  AccessLevel="Read" >
                <opc:Description>Localized Name of our custom node inside the system</opc:Description>
            </opc:Property>
            <opc:Property SymbolicName="Location" DataType="ua:String" ValueRank="Scalar"  AccessLevel="Read" >
                <opc:Description>World Readable location information </opc:Description>
            </opc:Property>
            <opc:Property SymbolicName="Manufacturer" DataType="ua:String" ValueRank="Scalar"  AccessLevel="Read" >
                <opc:Description>The device manufacturer </opc:Description>
            </opc:Property>
            <opc:Property SymbolicName="Model" DataType="ua:String" ValueRank="Scalar"  AccessLevel="Read" >
                <opc:Description>A unique Model number that can be referenced for our testing setup </opc:Description>
            </opc:Property>
        </opc:Children>
    </opc:ObjectType>

    <opc:ObjectType SymbolicName="DiagnosticsType" BaseType="ua:BaseObjectType">
        <opc:Description>Base class for publishing diagnostic information.</opc:Description>
        <opc:Children>
            <!-- variable definition for our generic sensor -->
            <opc:Variable SymbolicName="Fault" DataType="ua:Boolean" ValueRank="Scalar" >
                <opc:Description>Returns true if the device is outside of operational range </opc:Description>
            </opc:Variable>
            <opc:Variable SymbolicName="StatusOK" DataType="ua:Boolean" ValueRank="Scalar" >
                <opc:Description>Returns true if the device operates normal, Otherwise false</opc:Description>
            </opc:Variable>
        </opc:Children>
    </opc:ObjectType>

    <opc:ObjectType SymbolicName="AlarmsType" BaseType="ua:BaseObjectType">
        <opc:Description>Base class for generic alarm properties and variables.</opc:Description>
        <opc:Children>
            <!-- variable definition for our generic sensor -->
            <opc:Variable SymbolicName="AlarmHighLevel" DataType="ua:Boolean" ValueRank="Scalar" >
                <opc:Description>Indicated an active Alarm for ActualLevel greater than AlarmThresholdMax </opc:Description>
            </opc:Variable>
            <opc:Variable SymbolicName="AlarmLowLevel" DataType="ua:Boolean" ValueRank="Scalar" >
                <opc:Description>Indicated an active Alarm for ActualLevel less than AlarmThresholdMax </opc:Description>
            </opc:Variable>
            <opc:Variable SymbolicName="AlarmThresholdMin" DataType="ua:Double" ValueRank="Scalar" >
                <opc:Description>Controls the minimum FillLevel required to trigger a alarm on MinThreshold</opc:Description>
            </opc:Variable>
            <opc:Variable SymbolicName="AlarmThresholdMax" DataType="ua:Double" ValueRank="Scalar" >
                <opc:Description>Controls the maximum Filllevel required to trigger a alarm on MaxThreshold</opc:Description>
            </opc:Variable>
            <opc:Variable SymbolicName="AlarmsEnabled" AccessLevel="ReadWrite" DataType="ua:Boolean" ValueRank="Scalar" >
                <opc:Description>Controls the enabled Alarm functionality for the device </opc:Description>
            </opc:Variable>
        </opc:Children>
    </opc:ObjectType>

    <!--
        End of generics type definition
        Start of specific type configuration
    -->

    <opc:ObjectType SymbolicName="MeasurementsType" BaseType="ua:BaseObjectType">
        <opc:Description>Base type for measurement functions </opc:Description>
        <opc:Children>
            <!-- variable definition for our generic sensor -->
            <opc:Object SymbolicName="FillLevel" >
            <opc:Description>FillLevel of the connected device </opc:Description>
            <opc:Children>
                <opc:Variable SymbolicName="Absolute" AccessLevel="ReadWrite" DataType="ua:Double" ValueRank="Scalar" >
                    <opc:Description>FillLevel of the connected device in the configured unit </opc:Description>
                </opc:Variable>
                <opc:Variable SymbolicName="Percent" AccessLevel="ReadWrite" DataType="ua:Double" ValueRank="Scalar" >
                    <opc:Description>FillLevel of the connected device in Percent </opc:Description>
                </opc:Variable>
            </opc:Children>
            </opc:Object>
        </opc:Children>
    </opc:ObjectType>
    

    <!--
        Organizational elements for the node instances (valve, sensor, plc, tank)
    -->

    <opc:ObjectType SymbolicName="GenericTank" BaseType="ua:BaseObjectType">
        <opc:Description>Type definition for a custom water tank</opc:Description>
        <opc:Children>

            <opc:Object SymbolicName="Info"  TypeDefinition="DeviceInfoType">
                <opc:Description> Generic device information and base parameters </opc:Description>
                <opc:ReferenceType>ua:HasProperty</opc:ReferenceType>
            </opc:Object>

            <opc:Object SymbolicName="Diagnostics"  TypeDefinition="DiagnosticsType">
                <opc:Description> Diagnostic functions </opc:Description>
                <opc:ReferenceType>ua:HasComponent</opc:ReferenceType>
            </opc:Object>

            <opc:Object SymbolicName="Specification" TypeDefinition="ua:BaseObjectType">
                <opc:Description> Fixed parameters fo the device </opc:Description>
                <opc:Children>
                    <opc:Property SymbolicName="Capacity" AccessLevel="ReadWrite" DataType="ua:Double" ValueRank="Scalar" >
                        <opc:Description>Capacity of the tank </opc:Description>
                        <opc:ReferenceType>ua:HasProperty</opc:ReferenceType>
                        <opc:DefaultValue>
                            <uax:Double>10.0</uax:Double>
                        </opc:DefaultValue>
                    </opc:Property>
                </opc:Children>
            </opc:Object>

            <opc:Object SymbolicName="Configuration">
                <opc:Description> Configurable custom parameters of the device </opc:Description>
                <opc:Children>
                    <opc:Variable SymbolicName="MaxLevelPercent" AccessLevel="ReadWrite" DataType="ua:Double" ValueRank="Scalar" >
                        <opc:Description>Maximum allowed fill level for the tank </opc:Description>
                        <opc:ReferenceType>ua:HasProperty</opc:ReferenceType>
                    </opc:Variable>
                    <opc:Variable SymbolicName="MinLevelPercent" AccessLevel="ReadWrite" DataType="ua:Double" ValueRank="Scalar" >
                        <opc:Description>Minimum allowed fill level in percent </opc:Description>
                        <opc:ReferenceType>ua:HasProperty</opc:ReferenceType>
                    </opc:Variable>
                </opc:Children>
            </opc:Object>

        </opc:Children>
    </opc:ObjectType>


    <opc:ObjectType SymbolicName="GenericSensor" BaseType="ua:BaseObjectType">
        <opc:Description>Type definition for a custom water sensor </opc:Description>
        <opc:Children>
            <opc:Object SymbolicName="Info"  TypeDefinition="DeviceInfoType">
                <opc:Description> Generic device information and base parameters </opc:Description>
                <opc:ReferenceType>ua:HasProperty</opc:ReferenceType>
            </opc:Object>
            <opc:Object SymbolicName="Diagnostics"  TypeDefinition="DiagnosticsType">
                <opc:Description> Generic diagnostic functions </opc:Description>
                <opc:ReferenceType>ua:HasComponent</opc:ReferenceType>
            </opc:Object>
            <opc:Object SymbolicName="Specifications" TypeDefinition="ua:BaseObjectType">
                <opc:Description> Generic specification </opc:Description>
                <opc:ReferenceType>ua:HasProperty</opc:ReferenceType>
            </opc:Object>
            <opc:Object SymbolicName="Alarms"  TypeDefinition="AlarmsType">
                <opc:Description> Alarm related configuration and flags </opc:Description>
                <opc:ReferenceType>ua:HasComponent</opc:ReferenceType>
            </opc:Object>
            <opc:Object SymbolicName="Measurement"  TypeDefinition="MeasurementsType">
                <opc:Description> Measurement functions and properties defined by the sensor </opc:Description>
                <opc:ReferenceType>ua:HasComponent</opc:ReferenceType>
            </opc:Object>
        </opc:Children>
    </opc:ObjectType>
    


    <opc:ObjectType SymbolicName="GenericPlc" BaseType="ua:BaseObjectType">
        <opc:Description>Type definition for a custom plc </opc:Description>
        <opc:Children>
            <opc:Object SymbolicName="Info"  TypeDefinition="DeviceInfoType">
                <opc:Description> Generic device information and base parameters </opc:Description>
            </opc:Object>
            <opc:Object SymbolicName="Diagnostics"  TypeDefinition="DiagnosticsType">
                <opc:Description> Diagnostic functions and properties </opc:Description>
            </opc:Object>
        </opc:Children>
    </opc:ObjectType>

    <!--
        Define concrete types for the various controllers, sensors and actuators used in the model.
    -->
    
    <opc:Object SymbolicName="Devices"  TypeDefinition="ua:FolderType" >
    <opc:BrowseName>Devices</opc:BrowseName>
    <opc:DisplayName>Devices</opc:DisplayName>

    <opc:Children>
        <opc:Object SymbolicName="S001" TypeDefinition="GenericSensor" ModellingRule="Mandatory"> 
        <opc:Description>Levelsensor of Tank T001 </opc:Description>
        <opc:ReferenceType>ua:HasComponent</opc:ReferenceType>
        <opc:BrowseName>S001</opc:BrowseName>
        <opc:DisplayName>S001</opc:DisplayName>
        </opc:Object>

    </opc:Children>
    
    <opc:References>
        <opc:Reference IsInverse="true">
            <opc:ReferenceType>ua:Organizes</opc:ReferenceType>
            <opc:TargetId>ua:ObjectsFolder</opc:TargetId>
        </opc:Reference>
    </opc:References>
    </opc:Object>

</opc:ModelDesign>